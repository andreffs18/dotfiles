#!/usr/bin/env bash

# Remove all runnning processes for given name
# eg: $ killps chrome
function killps(){ 
    ps -ef | grep $1 | grep -v grep | awk '{print $2}' | xargs kill -9; 
}


# Find given string on given folder
# eg: $ findstr "documents.txt" .
function findstr(){
    find $1 \( -name node_modules -prune \) -o -name "*.py" -exec grep --color -Hn "$2" {} 2>/dev/null \;
}


# Shortcut to commit and push changes to current branch
# eg: $ gitcp "This is a commit message"
function gitcp(){
	current_branch=$(git symbolic-ref HEAD --short)
	echo "Commit Message: \"$1\"";
	echo "origin->$current_branch";
	git commit -am "$1";
	git push origin $current_branch;
	echo "Success!";
}


# Select random emoji and display it as "Hello" screen.
function olhaaqui(){
  EMOJIES=(âœ… ğŸ’© ğŸš€ ğŸ‘â€ğŸ—¨ â—ï¸ ğŸ˜­ ğŸ‰ ğŸ˜˜ ğŸ‘‹ âš¡ï¸)
  # Get random emoji from list
  EMOJI=${EMOJIES[$RANDOM % ${#EMOJIES[@]}]}
  # Check if emoji was previously used. If so use that, otherwise, download it.
  OLD_PWD=$(PWD)
  cd ~/
  if [ ! -f "$EMOJI.txt" ] ; then
    echo "Downloading \"$EMOJI\"..."
    # Download image using Emoji API
    wget --quiet "https://xn--i-7iq.ws/emoji-image/$EMOJI.png?format\=emojione\&ar\=1x1" -O $EMOJI.png
    # Convert image from .png to .jpg
    convert $EMOJI.png $EMOJI.jpg
    # Convert image to ascii art
    jp2a --size=96x46 $EMOJI.jpg --output=$EMOJI.txt
    # Replace all border "M" characters with empty space
    sed -i.bak "s/M/ /g" $EMOJI.txt
    # Delete temp files
    rm $EMOJI.png $EMOJI.jpg $EMOJI.txt.bak
  fi
  cd $OLD_PWD
  # Print image
  cat ~/$EMOJI.txt | lolcat
}

# Shortcut to get a random article from my Feedly account
# from the "Saved for Later" tag
# eg: $ sfl
function sfl(){
	python3 $HOME/.dotfiles/bin/feedly_read_later.py
}


# WIP: Focus function that does the following:
# - Turn on "No Disturb Mode" on mac
# - Open Pomodor app with 25 minute
# - Setup alarm for 5 minute break
# - Start spotify "focus" playlist
# function focus(){}

log.success ".functions loaded with success!"